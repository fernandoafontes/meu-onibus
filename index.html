<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BusHorários - Público</title>
    <style>
        :root {
            --verde-escuro: #1A3C34;
            --verde-medio: #2E7D32;
            --branco: #ffffff;
            --cinza-claro: #f8f9fa;
        }

        body { 
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; 
            margin: 0; 
            background-color: var(--cinza-claro); 
            color: #333;
        }

        header { 
            background-color: var(--verde-escuro); 
            color: var(--branco); 
            padding: 25px 15px; 
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .container { padding: 20px; max-width: 600px; margin: auto; }

        .controles { margin-bottom: 20px; }

        label { font-weight: bold; color: var(--verde-escuro); display: block; margin-bottom: 5px; }

        select { 
            width: 100%; 
            padding: 12px; 
            border-radius: 8px; 
            border: 2px solid var(--verde-medio); 
            font-size: 16px;
            background: white;
        }

        .card { 
            background: white; 
            padding: 20px; 
            border-radius: 12px; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.08); 
            margin-top: 20px;
        }

        h2 { color: var(--verde-escuro); margin-top: 0; border-bottom: 2px solid var(--cinza-claro); padding-bottom: 10px; }

        .time-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(70px, 1fr)); 
            gap: 10px; 
            margin-top: 15px; 
        }

        .time-item { 
            background: var(--verde-medio); 
            color: var(--branco); 
            padding: 8px 5px; 
            text-align: center; 
            border-radius: 6px; 
            font-weight: 600;
            font-size: 0.9rem;
        }

        .footer-info { text-align: center; font-size: 0.8rem; color: #777; margin-top: 30px; }
    </style>
</head>
<body>

<header>
    <h1 style="margin:0">BusHorários</h1>
    <p style="margin:5px 0 0; opacity:0.8">Consulte sua linha rapidamente</p>
</header>

<div class="container">
    <div class="controles">
        <label for="linhaSelect">Selecione a Linha:</label>
        <select id="linhaSelect" onchange="mostrarHorarios()">
            <option value="">Carregando linhas...</option>
        </select>

        <label for="diaSelect" style="margin-top:15px">Tipo de Dia:</label>
        <select id="diaSelect" onchange="mostrarHorarios()">
            <option value="Util">Dias Úteis</option>
            <option value="Sabado">Sábados</option>
            <option value="Domingo">Domingos e Feriados</option>
        </select>
    </div>

    <div id="resultado" class="card" style="display:none;">
        <h2 id="tituloResultado">Horários</h2>
        <div class="time-grid" id="listaHorarios"></div>
    </div>
</div>

<div class="footer-info">Dados atualizados via arquivo .txt</div>

<script>
    let dadosGerais = [];

    // Função para carregar o arquivo TXT
    async function carregarDados() {
        try {
            const response = await fetch('dados.txt');
            const texto = await response.text();
            const linhas = texto.split('\n');
            
            dadosGerais = linhas.map(l => {
                const colunas = l.split(',');
                return {
                    nome: colunas[0],
                    tipo: colunas[1],
                    horarios: colunas.slice(2)
                };
            }).filter(item => item.nome); // Remove linhas vazias

            popularSelectLinhas();
        } catch (erro) {
            console.error("Erro ao carregar dados:", erro);
            alert("Erro ao carregar os horários. Verifique o arquivo dados.txt.");
        }
    }

    function popularSelectLinhas() {
        const select = document.getElementById('linhaSelect');
        const linhasUnicas = [...new Set(dadosGerais.map(d => d.nome))];
        
        select.innerHTML = '<option value="">Escolha uma linha...</option>';
        linhasUnicas.forEach(linha => {
            const option = document.createElement('option');
            option.value = linha;
            option.textContent = linha;
            select.appendChild(option);
        });
    }

    function mostrarHorarios() {
        const linhaEscolhida = document.getElementById('linhaSelect').value;
        const diaEscolhido = document.getElementById('diaSelect').value;
        const listaDiv = document.getElementById('listaHorarios');
        const resDiv = document.getElementById('resultado');

        if (!linhaEscolhida) {
            resDiv.style.display = 'none';
            return;
        }

        const busca = dadosGerais.find(d => d.nome === linhaEscolhida && d.tipo === diaEscolhido);

        listaDiv.innerHTML = '';
        if (busca && busca.horarios.length > 0) {
            busca.horarios.forEach(h => {
                if(h.trim() !== "") {
                    const item = document.createElement('div');
                    item.className = 'time-item';
                    item.textContent = h;
                    listaDiv.appendChild(item);
                }
            });
            document.getElementById('tituloResultado').textContent = linhaEscolhida;
            resDiv.style.display = 'block';
        } else {
            listaDiv.innerHTML = '<p>Nenhum horário encontrado para este dia.</p>';
            resDiv.style.display = 'block';
        }
    }

    // Iniciar carregamento ao abrir a página
    window.onload = carregarDados;
</script>

</body>
</html>
